ARG BUNDLE=lang

FROM fulviofarina/omc-${BUNDLE}:latest AS bundle-version-git

LABEL FULVIO_FARINA=<fulviofarina@gmail.com>
USER root
#libs

ARG GIT_VERSION=2.38.1
RUN apt-get install -y libz-dev libssl-dev libcurl4-gnutls-dev libexpat1-dev gettext cmake gcc \
#####GIT
&& cd /${HOME} \
&& curl -o git-${GIT_VERSION}.tar.gz https://mirrors.edge.kernel.org/pub/software/scm/git/git-${GIT_VERSION}.tar.gz \
&& tar -zxf git-${GIT_VERSION}.tar.gz && cd git-* && make prefix=/usr/local all \
&& make prefix=/usr/local install && exec bash \
&& git --version \
&& rm -rf /${HOME}/git-${GIT_VERSION}.tar.gz \
&& rm -rf /${HOME}/git-${GIT_VERSION} \
#&& rm -rf git-2.38.1 \
#### cleanup
&& apt-get upgrade -y && apt-get autoremove -y
###### pip git
RUN pip install jupyterlab-git && pip list

## SAVE THE ORIGINAL PROFILE

ARG REPO_FOLDER=repositories
ARG REPO=${HOME}/${REPO_FOLDER}

#RUN git clone https://github.com/mit-crpg/OpenMOC $REPO/OpenMOC/
RUN git clone https://github.com/mit-crpg/openmc-reactor-examples $REPO/openmc-reactor-examples/ \
&& git clone https://github.com/mit-crpg/openmc-workshop $REPO/openmc-workshop/ \
&& git clone https://github.com/mit-crpg/benchmarks $REPO/benchmarks/ \
&& git clone https://github.com/mit-crpg/BEAVRS $REPO/BEAVRS/ \
&& git clone https://github.com/mit-crpg/fet-stationarity $REPO/fet-stationarity/ \
&& git clone https://github.com/mit-crpg/WMP_Library $REPO/cloud/WMP_Library/ \
&& git clone https://github.com/mit-crpg/vectfit $REPO/vectfit/ \
&& git clone https://github.com/mit-crpg/TIMCAT $REPO/TIMCAT/

ENTRYPOINT [ "/bin/bash", "-l"]
